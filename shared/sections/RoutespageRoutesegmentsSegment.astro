---
import { mdxComponentsAstro } from '@shared/cms/components/mdxComponentsAstro.astro'
import Section from '@shared/layouts/Section.astro'
import { getCollection } from 'astro:content'
import RoutespageRoutesegmentDetail from './RoutespageRoutesegmentDetail.astro'
import type { Segment } from './RoutespageRoutesegments.astro'

type Props = { route: Segment }
const { route } = Astro.props
const { Content } = await route.render()
const routesegmentdetails = await getCollection('routesegmentdetails')
export type Segmentdetail = (typeof routesegmentdetails)[number]
---

<Section prose>
  <header id={route.slug} class="scroll-m-8">
    <h2>{route.data.title}</h2>
    <p>Baulasttr√§ger/in: {route.data.operator}</p>
  </header>

  <article>
    <Content components={mdxComponentsAstro} />
  </article>

  <h3>Detailinfos</h3>
  <ol class="not-prose divide-y divide-gray-200 border-y">
    {
      routesegmentdetails
        .filter((detail) => detail.data.route === route.slug)
        .map((detail) => (
          <li>
            <RoutespageRoutesegmentDetail detail={detail} />
          </li>
        ))
    }
  </ol>
</Section>
